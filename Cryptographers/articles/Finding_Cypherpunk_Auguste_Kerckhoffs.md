# 寻找密码朋克（一）：奥古斯特·柯克霍夫传

作者：Peng SUN


> “即使密码系统的任何细节已为人悉知，只要密钥未泄露，它也应是安全的。”
>  ——柯克霍夫原则

![Auguste Kerckhoffs](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.1%20Auguste%20Kerckhoffs.jpg?raw=true )


Fig. 1: Auguste Kerckhoffs（1835-1903），荷兰语言学家、密码学家

## 一、引言
生而为人，自会有秘密，每个人天赋应拥有自己的隐私。但大多数人可能与我一样，从小到大很难去掌握自己的隐私。还记得中学时代早恋的我们吗，每天要跟喜欢的人传递很多次小纸条，但总难免会有些意外发生。比如，一张纸条要过很多人的手才能传到自己或对方的手中，这期间小纸条的内容要么会被传递者偷偷翻看，要么就会在传递过程中被老师抓获。一旦写满情话的小纸条内容被他人看到，我们难免陷入尴尬；如果被老师发现，那可就要挨批、写检讨，甚至带家长了。相信相当一部分小伙伴都会有类似的经历。

如果可以，谁希望自己的隐私泄露呢？有人可能会想到用胶带把小纸条密封住，也可以把小纸条夹在书本里。但其实这换汤不换药，一旦次数多了，大家总会有所意识。还会有同学想到对小纸条的内容进行加密，比如，“我很想你，放学后我们一起走吧”这样的文字，用别人看不懂的符号来表达，就是“BHLGDCMJBIFNAEK”：


| A  | B | C | D | E | F | G | H | I | J | K | L | M | N
| --- | --- | --- |--- |--- |--- |--- |--- |--- |--- |--- |--- |--- |--- |
| 走  | 我 | 放 | ， | 吧 | 一 | 你 | 很 | 们 | 后 | 。 | 想 | 学 | 起


这是古典密码学的方法，加密与解密的过程更有艺术性和趣味性。不过，在现代社会中存在的风险比较大。因为信息的频繁传递需要变换不同的机制，而每次机制都要跟随小纸条一起传递，所以仍然不会有太好的效果。如果双方使用一套完备的符号转换机制，那么在一定时间内，人或者现代计算机都可以破解。因此，当使用古典密码学方法时，双方通信过程中的信息始终是在不安全的信道中传输的。

有没有一种办法彻底解决信道安全的问题呢？目前不太可能，但是如果基于信道是不安全的假设，现代密码学提供了“对称/私钥密码学”和“非对称/公钥密码学”两种实现密码系统的安全的方案：

第一种是“对称/私钥密码学”。假设有一个专门适用于存放小纸条的小保险箱，Alice 和 Bob 为此配了两把相同的钥匙，每次存放完小纸条后都给保险箱上锁，这个小保险箱经由多位同学之手到达 Alice 手中后可以用钥匙解锁，回复完信息后再用钥匙上锁，传给 Bob 后再用同一把钥匙解锁即可，这样就可以确保信息在传送过程中的安全。但这个方法也有缺点，因为两个人使用的是相同的钥匙，如果其中一把钥匙不小心被情敌搞到手，他/她复制了一把相同的钥匙，之后就可以在通信双方均不知情的情况下偷偷查看双方的信息。

第二种方案是“非对称/公钥密码学”。某个周末，Alice 和 Bob 一起去买了两套机制相同的保险箱，每个保险箱都有公钥和私钥。这个公钥表明谁是该保险箱的所有者，而保险箱则保证每张小纸条放进去之后无法取出，只能通过私钥打开保险箱。当 Alice 要给 Bob 写信时，她把小纸条塞进 Bob 的保险箱里，经由多为同学传递后到 Bob 的手中后，Bob 用他自己的私钥打开保险箱。在整个通信过程中，除了掌握私钥的 Bob ，无人可以打开 Bob 的保险箱，即使是 Alice 也不行。反过来，如果 Bob 要给 Alice 写信，只需使用带有 Alice 公钥的保险箱即可。而发现这种密码系统的实用性后，其他同学也会感到兴趣，他们也可以购买带有公钥与私钥的保险锁，之后大家都能愉快地使用这种密码系统进行隐私交流了。

这就是现代密码学的核心要点：秘密与隐私绝不能因为密码系统在信道中被拦截而泄露，密码系统的安全只需要取决于密钥（公钥密码学中取决于私钥）的安全。

不过，在生活中我们对密码学的感知较少，通常接触到的是不同信息系统的账号登录密码。但这类密码只是一种便于人类可读与记忆的用户口令，计算机会用它来生成更为复杂的密码学意义上的密钥。

实际上，在现代社会中，基于现代密码学技术的应用已经无形地渗透到日常工作生活的方方面面，我们在网络上的各种隐私、数据与资产就是被幕后的密码学所加密与保护的。譬如，二代身份证、防伪火车票/电子发票、银行卡/网银 U 盾、汽车智能钥匙、4G/5G/WiFi、移动通话、微信信息传输、语音/视频通话、电子邮件、移动支付、网络购物、百度/谷歌/阿里云盘、Web 网页的 HTTPS 访问等等。

那么，这样一个影响现代社会如此深刻的密码学思想是谁最先提出的呢？为什么会设计出这种密码系统？
通常情况下，有人会想到现代密码学的奠基人香农，他那篇基于信息论的[《保密系统的通信理论》](https://pages.cs.wisc.edu/~rist/642-spring-2014/shannon-secrecy.pdf)将“敌人知道系统”作为对一个系统安全性分析时的安全假设。然而，“敌人知道系统”只是香农对前人思想的一个提炼与总结，真正的发明者是19世纪的一位荷兰语言学家与密码学家奥古斯特·柯克霍夫（Auguste Kerckhoffs）。

1883 年初，柯克霍夫在《军事科学杂志》（Journal des Sciences Militaires）上发表两份题为《军事密码学》（*[La Cryptographie Militaire](https://www.petitcolas.net/kerckhoffs/lacryptographiemilitairei.htm)*）的报告，一举奠定其在现代密码学上的先驱者地位。时至今日，密码学与网络安全领域的学术专著与论文仍然在引用柯克霍夫的力作，Twitter、Medium、Reddit 等社交平台上依稀可见柯克霍夫的身影。这些文献引用的大多是柯克霍夫在《军事密码学》中提出的关于密码安全系统的六项原则[10]：

* 即便如果做不到数学上不可破解，系统也应在实用程度上无法破解；
* 系统内不应含任何机密物，即便落入敌人手中也不会造成困扰；
* 密钥必须易于沟通和记忆，而不须写下；且双方可以容易地改变密钥；
* 系统应可以用于电报通讯；
* 系统应可以携带，不应需要两个人或以上才能使用（应只要一个人就能使用）；
* 系统应容易使用，不致让使用者的脑力过分操劳，也无需记得长串的规则。

这些原则放在今天仍然适用，并具有指导意义。在这六项原则中，其中第二条已被提炼为著名的“柯克霍夫原则”。尽管诞生于电报时代，但他所主张的系统公开的密码学原则具有开放性与共享性，完全适用于计算机、互联网与万维网上的通信需求，因而对20世纪中叶以来的一整个现代密码学、公钥密码学、开放源代码运动与区块链等等技术及加密社区产生深远影响。

作为古典密码学与现代密码学史上承前启后的人物，柯克霍夫的价值不言而喻。

早在 1998 年，世界语爱好者吉恩-克劳德·加纳科曾[为柯克霍夫作传](https://vo.wikipedia.org/wiki/Auguste_Kerckhoffs)；2013年，法国巴黎高等师范学院的两位密码学家雷米·格罗-斯图尔特与大卫·纳卡奇在加纳科的基础上搜集新的档案资料重新为柯克霍夫书写传记，其文[《柯克霍夫的遗产》](https://eprint.iacr.org/2020/556)更加全面而详尽地介绍了柯克霍夫的一生。然而，中文世界对此成果知之甚少。

今天，作为密码学爱好者，我们有责任也有必要为这位伟大的密码学家正传。在本文的写作过程中，我们曾与《柯克霍夫的遗产》一文的作者们电邮沟通过诸多历史与资料问题，由于时间与空间的限制，本文无法进一步获取藏于法国的关于柯克霍夫的一手档案资料。但是，这并不代表本文的写作只能是对前人研究的模仿与抄袭。

相反，本文试图在既有资料的基础上，以新的结构与视角重新梳理史料，化零为整，重新书写柯克霍夫，向更广泛的公众介绍他的一生。与《柯克霍夫的遗产》不同之处还在于，前者并未介绍柯克霍夫与密码学，但本文不仅将给读者呈现《军事密码学》的人文渊源与政治社会背景，还将逐个分析《军事密码学》的贡献及其与当代社会密码学应用之间的联系。

## 二、学业与职业：柯克霍夫的智识追求与启蒙使命
1835 年 1 月 19 日，在荷兰林堡公国的努斯村（林堡省最大的市镇），让-纪尧姆-于尔贝-维克多-弗朗索瓦-亚历山大-奥古斯特·柯克霍夫·冯·纽文霍夫（Jean-Guillaume-Hubert-Victor-François-Alexandre-Auguste Kerckhoffs von Nieuwenhof）出生了。柯克霍夫从小生活在一个享有社会特权的家庭中，其父让·纪尧姆·柯克霍夫是当时努斯村长、书记官和和治安法官（juge de paix），其母是珍妮特·伊丽莎白·林特詹斯。[[5](#ref-5)]他的家族成员大多是医生、博士与政府官员，社会地位与文化水平（详见附录）较高。

柯克霍夫从小读书就展现着卓越的智商，而优渥的家庭环境也使他可以无忧无虑地在知识的海洋里徜徉。终其一生，他却从未离开对智识生活的追求，甚至肩负起现代法国教育的启蒙使命。
### （一）早年的现代科学启蒙
关于柯克霍夫早年的档案资料并不多，最早始于 1847 年，12 岁的他在荷兰罗尔杜克的寄宿学校读了 5 年书。凯尔克拉德市政档案显示，柯克霍夫的期末成绩从一年级时的全班第六名进步到四年级时的全班第三名，每个学年他都能拿到二等或三等奖学金，始终都处在班级最好的学生之列。

童年的读书经历为他打好了数学、历史、法律与地理等方面的知识基础，而默兹河畔马斯特里赫特的体育馆则将17岁的柯克霍夫带入科学知识的殿堂。20 岁时，柯克霍夫在比利时的列日大学学习两年哲学。大学期间，他将自己的名字简化，也就是我们今天所记住的 Auguste Kerckhoffs。与此同时，他还在鲁汶攻读自然科学。至 1857 年大学毕业时，柯克霍夫已经具备良好的现代科学知识基础，他的读书生涯也暂且告一段落。[[5](#ref-5)]
### （二）反哺社会：职业教师生涯的开启
在柯克霍夫的一生中，语言的兴趣贯穿始终。尽管在他看来，语言只是一种工具，但他却将语言教学作为一生的事业。大学毕业后，柯克霍夫就前往住着巴达维亚人（在文艺复兴时代被认为是荷兰人的祖先）的埃因霍温城开始其教授现代语言的职业教师生涯。1860 年，柯克霍夫离开埃因霍温前往法国莫城的一所私人机构教书，并用一年时间游学英国完善自己的英语。1863 年，他从莫城辞职后奔赴默伦，担任英语与德语教师。同年 10 月 19 日，他被任命为默伦学院院长。

刚进默伦的头三年，30 岁的柯克霍夫便幸运地组建了自己的家庭。他认识了一位名叫玛丽·埃米莉·特维宁的法国女子，两人于 1864 年 7 月 5 日在巴黎第十区结婚，他们的爱情结晶诞生在 1865 年 5 月 13 日，这个新生的女婴被称为宝琳。[[5](#ref-5)]

![结婚证书](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.2%20%E7%BB%93%E5%A9%9A%E8%AF%81%E4%B9%A6.jpg?raw=true)

Fig. 2：巴黎档案馆藏柯克霍夫与特维宁的结婚证书

图片来源：“[Kerkchoffs’ Legacy](https://eprint.iacr.org/2020/556.pdf)” written by Jean-Claude Caraco, Rémi Géraud-Stewart, and David Naccache.

![宝琳出生证明](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.3%20%E5%AE%9D%E7%90%B3%E7%9A%84%E5%87%BA%E7%94%9F%E8%AF%81%E6%98%8E.jpg?raw=true)

Fig. 3：默伦档案馆藏 1865 年 5 月 13 日宝琳的出生证明

图片来源：“Kerkchoffs’ Legacy”.


家庭并没有影响柯克霍夫的事业与追求，在默伦的十年，他兼收并蓄，将智识追求与教育事业相结合。一方面，他持续学习现代和古代语言、数学、历史和考古学的新知识；另一方面，他对教育事业的热诚与奉献精神也彻底地释放，他相信通过教育可以帮助法国人民完成启蒙，走向现代与科学。因为在当时的法国，教育长期被天主教会把持，而教会则是反现代、反理性的蒙昧化身。1867 年，省议会批准柯克霍夫每年冬季在默伦开设免费的英语课程。此外，他还是默伦“鼓励教育协会”的主要创始人之一，并以勤奋而又无私的精神为该协会的“秘书-图书馆员”一职鞠躬尽瘁。[[5](#ref-5)]

事业的蒸蒸日上也使柯克霍夫的生活条件相当富足。据估计，他在默伦工作的年薪大约是 2000 法郎①，而其总资产则达到 25000 法郎，同时他每年还可以通过让学生在家中借宿与教学赚取 3000-4000 法郎的额外收入。[[5](#ref-5)]
### （三）柯克霍夫博士：学缘再续与职业生涯新起点
事业上的成就并没有阻止柯克霍夫的内心，他终究是一个有智性追求的知识分子。尽管他已能够教授学生德语，但他对知识的渴望仍然促使其向语言学更加深奥的领域深造。早在 1871 年，他就通过了评估其德语教学能力的竞争性考试。1873 年初，他离开默伦学院，前往德国波恩大学和图宾根大学攻读德国古典语言学。1876 年，柯克霍夫毕业时拿到德国哲学博士与文科硕士学位。[[5](#ref-5)]换言之，柯克霍夫在三年的时间里完成两所大学硕博训练，这种学习力相当罕见。

博士期间，柯克霍夫在欧洲大陆的政治社会地位与荣誉也显著提高。他因担任即将成为葡萄牙国王秘书的圣马梅德家族年轻伯爵罗德里戈·佩雷拉·费利西奥·德·圣马梅德的导师，而被授予葡萄牙基督勋章骑士等级。而 1876 年至 1880 年间，柯克霍夫又辅导该家族的另外两个孩子，相继被授予基督勋章与葡萄牙圣詹姆斯军事勋章的军官徽章。[[5](#ref-5)]

![简历](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.4%20%E6%8B%89%E4%B8%81%E6%96%87%E7%AE%80%E5%8E%86.jpg?raw=true)

Fig. 4：1876 年柯克霍夫的拉丁文简历

图片来源：“Kerkchoffs‘ Legacy”.

![博士](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.5%20%E5%8D%9A%E5%A3%AB%E6%96%87%E5%87%AD.jpg?raw=true)

Fig. 5：柯克霍夫的博士文凭

图片来源：“Kerkchoffs‘ Legacy”.


博士学历的加成为柯克霍夫的职业生涯提供了帮助，他去了更好的学校任教。1880 年，柯克霍夫申请到法国著名的军事学院综合理工学院担任德语系主任，但因一个职员没有记录他已于 1873 年归化为法国公民，最终未被录取。次年 11 月 1 日，柯克霍夫获得巴黎高等商学院德语教席，并在阿拉贡市立学校任教。

柯克霍夫并未停止脚步，他仍然想成为现代法国启蒙教育事业的担纲者，希望在一所师范学校中获得德语教席。然而，这一次他并没有得到眷顾，随后他也离开了阿拉贡学校。不过，好运最终还是来了。1883 年，当法兰西第三共和国总理茹费里推动“免费、义务、世俗”的国民教育以实现法国教育世俗化时，由于柯克霍夫长期为“鼓励教育协会”和默伦教育所做出的无私贡献，法国公共教育部为他颁发学术官员（Academic Officer）头衔。[[5](#ref-5)]

![柯克霍夫居住在巴黎克劳德·贝尔纳街](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.6%20%E5%B7%B4%E9%BB%8E%E5%85%8B%E5%8A%B3%E5%BE%B7%C2%B7%E8%B4%9D%E5%B0%94%E7%BA%B3%E8%A1%97.jpg?raw=true)

Fig. 6：柯克霍夫居住在巴黎克劳德·贝尔纳街（Rue Claude Bernard）62 号（左侧）

图片来源：“Kerkchoffs‘ Legacy”.

### （四）跻身主流知识界：柯克霍夫的学术交游
除了对知识的追求与对教育事业的虔诚，柯克霍夫那博学取向的智识生活还体现在学术交往上。他一生交游广泛，早在 1860 年左右就曾与维克多·雨果有书信往来，他还作为法国考古学会地方分支机构代表参加 1868 年在德国波恩举行的国际大会。[[5](#ref-5)]

1883 年，柯克霍夫正式加入巴黎人类学会。该学会成立于 1859 年，是世界上第一个使用“人类学”术语的学术社团，它以将科学与哲学综合作为目标，包括医学、古生物学、民族学、考古学、语言学、社会学、心理学、哲学等学科。巴黎人类学会采用会员邀请制，参与社团活动的多是医生、语言学家、古人类学家、行政人员、艺术家等社会地位较高的人。雷米·格罗-斯图尔特表示，柯克霍夫或许是由熟人介绍的。更有可能的是，他发现自己对巴黎人类学会的话题感兴趣，并试图寻找志同道合的朋友。

巴黎人类学会的发展于 1880 年前后达到顶峰，柯克霍夫在这一时期加入显然可以认识到更多的知识分子和学者。在此之后，柯克霍夫在智识上的追求有了更广阔的发展空间。譬如，柯克霍夫在 1873 年曾在《塞纳-马恩省考古学会公报》上发表《纪念碑艺术与宗教思想》学术论文，但在加入巴黎人类学会之后，他在 2 年内连续在《巴黎人类学会学报》等期刊上发表 5 篇考古学与人类学的学术论文。除了考古学上的精进，巴黎人类学会的语言学家还为后文将提到的柯克霍夫的沃拉普克语提供帮助。[[11](#ref-11)]
## 三、现代密码学的先驱：柯克霍夫与《军事密码学》
在加入巴黎人类学会的同一年，柯克霍夫发表了著名的《军事密码学》。这篇论文在密码学史上起着承前启后的作用，它不仅对古典密码学做了系统总结与分析，还为 20 世纪中叶诞生的现代密码学提供灵感。

本章将从密码学与考古学的人文渊源、普法战争的时代背景谈起，介绍柯克霍夫从事密码学研究的根源何在，其次探讨柯克霍夫的密码学洞见及其为后世密码学所做出的伟大贡献。
### （一）密码学与考古学的人文渊源
在现代密码学诞生之前，古典密码学更多是一门艺术，隶属于人文学科的范畴。譬如，密码学也是当时巴黎人类学会的讨论议题。从一开始，密码学就与文本、语言紧密相关。

首先，作为学科概念的密码学（cryptology）包括密码编码学（cryptography）与密码分析学（cryptanalysis），古典时代的密码学是军事需要的产物，军事秘密信息的传递往往将一种普遍可读的“语言”加密成另一种通常无法理解的文字或符号，破译者只有掌握这一套加密规则/原理才能解读文本的真实内容，这是一种语言间的转化。譬如，凯撒大帝的《高卢战记》中提到使用希腊字母取代罗马字母，把信息转译成敌人看不懂的符号；中世纪时期，在阿拉伯帝国阿巴斯王朝的学术中心智慧宫（Bait al-Hikmah），许多阿拉伯学者为研究《古兰经》所载穆罕穆德的天启及其年代顺序，凭借其对语言学、数学、统计学与宗教学等学科的高度水平创造性地发明了破解单表密码的频率分析法。[[2](#ref-2)]

![智慧宫](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.7%20%E9%98%BF%E6%8B%89%E4%BC%AF%E6%99%BA%E6%85%A7%E5%AE%AB.png?raw=true)

Fig. 7：阿拉伯智慧宫，中世纪的学术中心

图片来源：https://mvslim.com/bayt-al-hikma-proves-us-that-islam-and-science-arent-and-were-never-contradictions/

到了 18 世纪末，密码学最浪漫的文字解译成就是离不开考古学的。1799 年，在拿破仑的埃及远征军中随行 154 名法国学者邂逅了考古学史上最有名的罗塞塔石碑（Rosetta Stone），法国语言学家商博良破译了世界上最古老的密码之一——古埃及象形文字。商博良之后，考古学家趋之若鹜，苏美尔与巴比伦的楔形文字（Cuneiform）、印度的婆罗米文（Brahmi）相继得到破译，而人们对密码学的兴趣也日益增加。[[2](#ref-2)]譬如，第一位将数学引入密码学以破译多表替代密码的查尔斯·巴贝奇对考古学感到兴趣，而后文将提到的同样破解了多表替代密码的弗里德希·卡西斯基在研究密码学后则转向了考古学研究。[[1](#ref-1)]


![商博良破译象形文字的笔记](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.8%20%E8%B1%A1%E5%BD%A2%E6%96%87%E5%AD%97.jpg?raw=true)

Fig. 8：商博良破译象形文字的笔记

图片来源：https://www.facsimiles.com/facsimiles/champollions-notebook


从上文可知，1860 年代柯克霍夫已经介入考古学。因此，无论是柯克霍夫个人的语言学功底，还是 19 世纪法国学术整体发展态势，柯克霍夫对密码学的兴趣与研究无疑是一件顺其自然的事情。
### （二）普法战争的直接影响
必须指出，1883 年的《军事密码学》在某种程度上是爱国主义与民族主义的产物。这首先要追溯到 1870 年的普法战争。普法战争的根源在于俾斯麦领导下的普鲁士试图统一德意志，而这源于拿破仑统治欧洲时期，将城邦与王公合并，为日后德意志统一民族国家埋下种子。然而，1866年的普奥战争使法国意识到德意志统一进程威胁到法国在欧陆的主导地位，普鲁士的部分官员也希望通过对法战争唤起德意志民族主义。

1871 年，普法战争以法国战败、签订《法兰克福条约》（割让阿尔萨斯和摩泽尔省予德国、赔偿50亿法郎）而告终，通过战争实现统一的德意志帝国由此成为欧陆第一大国。普法战争割地赔款的耻辱条约深深刺痛着法国人的内心，国内产生强烈的复仇主义情绪。

尽管柯克霍夫是一个理性的知识分子，但他生活在一个受到法国大革命影响、热衷于发明现代民族国家的19世纪欧洲地缘中心。他对自己的定义就是一个爱国者、忠诚的公务员和天主教徒。[[5](#ref-5)]因此，无论是主动还是被动的，作为历史中人，他都无法置身事外。

1870 年，正在默伦学院工作的柯克霍夫得知战争的消息后，旋即加入法国国民警卫队。在整个战争期间，他是“为监狱服务的最坚定的人之一”，抵御普鲁士军队入侵，保卫巴黎[[5](#ref-5)]。或许柯克霍夫义无反顾地加入国民警卫队，也是因为战争爆发的4个月前，他正在申请法国国籍。

作为入籍的第一步，柯克霍夫在 3 月 16 日写信给司法部长，要求根据《拿破仑法典》第十三条允许他在法国享有居住权。5 月 23 日，柯克霍夫收到允许他在法国建立居住权的公函，但必须要等待三年才能申请法国公民。因此，柯克霍夫又于 8 月 29 日写信给司法部长，告知其在法国的服务已经超过三年，可以申请法国公民身份。[[5](#ref-5)]

法国政府部门对他的二次调查发生在三年后，此时正逢柯克霍夫准备出发前往德国攻读博士，出国计划被某些法国人猜测是关于德国入侵的，甚至认为“他与敌人有关系”。但是政府澄清了这一切，并且赞扬了柯克霍夫在国民警卫队的贡献。1873 年 11 月 19 日，法国国务委员会下令“柯克霍夫先生有权享受法国公民的权利”。[[5](#ref-5)]

1876 年，柯克霍夫行将毕业，面临着留德还是返法的选择。尽管他对德国古典语言的热爱是具有超越性的智识追求，但仍然声称：“我无法抗拒我对回家的渴望，也无法抗拒我妻子的渴望，她热爱她的祖国法国，此外，我的公职和我的良知禁止我拒绝为这个国家效力”[[5](#ref-5)]。

因此，回到法国后，柯克霍夫便开始与军方接触。

三年前，当他申请前往德国读博时，给法国政府的报告中便曾提及学习德国古典语言是为了之后能够在法国军事学院担任德语教师。如前文所述，他也如约申请过军事学院教席。当然，我们也很难猜测为什么军事学院需要一个德国古典语言教师。我们同样没有确凿的证据证明柯克霍夫与军方的关系，但部分材料若隐若现地表明，柯克霍夫可以深入地了解到法国军事密码学的现况与发展。

在《军事密码学》中，柯克霍夫引用法国“陆军总司令部最有才华的密码分析员之一”亨利·贝尔托特在克里米亚战争中“众所周知”的能力。这一事实发生在陆军部最秘密的部门，柯克霍夫却能了解贝尔托特在 1880 年的身份，并对其才能进行评论。此外，柯克霍夫还举了 1882 年哈瓦斯电报（Havas telegram）的例子，它是哈瓦斯通讯社伦敦站加密发往开罗分部的，内容与英国在埃及的军事行动相关。这封电报并没有公开，并且当时私人发送和接受加密电报是被禁止的（商业交流也可以使用加密）。哈瓦斯通讯社与法国内政部关系密切，享有独家通信手段和资金，柯克霍夫能够知道这封电报在一定程度上也暗示了自己的背景。《柯克霍夫的遗产》一文对柯克霍夫与军方的关系做了更多有依据地猜测。[[5](#ref-5)]

提及柯克霍夫与军方的关系是因为法国在战后仿照战时德国匆忙地建立了现代军事总参谋部，其中“军事统计局”（后改为情报局）专门收集和衡量各种情报。[[9](#ref-9)]对军事情报的密码分析需求是19世纪末叶法国密码学发展的原动力，柯克霍夫与军方的诉求在密码学上不谋而合。他敏锐地捕捉到法国在战争中失败的通信因素：

> “从 1879 年德国报纸在 1870 年发现塞纳河电缆的电报局局长马克思·赫林上尉去世时发表的讣告中可以看出，由于巴黎的军队和各省的将军之间缺乏安全的秘密通信系统为围攻者带来了什么帮助。”[[10](#ref-10)]


事实上，“缺乏安全的秘密通信系统”是由于 19 世纪电报的发明，它彻底扰乱了传统军事情报（尤其是密码学）的通信方式。普法战争时期的战地密码（field cipher）仍然是使用多表替代密码制作密码，对军事情报进行加密。这种编码机制决定了只要敌人知道这些密码编译的工作原理，当时所有已知的密码都可以被破解。

电报时代带来了新的窃听媒介，情报的传送会更快也更容易地被拦截与监视，而拦截情报后的密码破译工作则取决于密码分析水平。普鲁士挑起战争是有预谋的行动，故而提前创造了一套较难破解的编码作品，要求野战军官必须学会使用密码，并且在国内建立起强大的电报网，用于情报拦截。[[5](#ref-5)][[6](#ref-6)]

在密码分析上，普鲁士的水平远超法国。这得益于普鲁士军官弗里德希·卡西斯基于 1863 年出版的《密码和破译艺术》一书，该书用四分之三的篇幅回答了一个困扰了分析员 300 多年的问题，即如何实现重复密钥多表替代密码的一般破译，并且其中一章专门讲述“法文密码破译”。这本书被献给当时与俾斯麦、普鲁士总参谋长兼陆军元帅毛奇同等重要的普鲁士陆军大臣阿尔布莱希特·冯·罗恩伯爵，很显然，密码分析早早地就进入普鲁士高层视野，7 年后伯爵打造的军队击败了法国[[1](#ref-1)]。在另一边，法国虽也早已使用电报，但是在密码编码与密码分析上均着力不足。

### （三）《军事密码学》的贡献：现代密码编码与分析指南
柯克霍夫从基于考古学出发的密码学业余兴趣中脱离而出，他不仅回应了战后法国军事密码学的需求，还以更加专业的姿态直接面对着电报给通信带来的密码学新问题。

电报的发明是信息时代的开端[[3](#ref-3)]，它实现了人类通信的即时与迅速。但在当时，人们对战地密码的理解还停留在“只需在他传送的命令执行完毕前能抗住破译即可”的程度，这完全不适合电报时代的密码学需求，因为“在远距离通信中，秘密事项常常在信息发出日之后依然重要”[[10](#ref-10)]。柯克霍夫曾对这一现象作出批评：

> ……对于我们的教授和学者讲授、推荐的战时密码系统，一个最没有经验的分析员用不了一小时就能发现密钥，这点实在令我惊讶。

> 这种对某些特定密码的过度自信，我很难解释，恐怕只有黑室的消失和邮政通信的保密使得密码学研究停滞不前才说得通；类似地，很有可能，某些作者的夸大其词，加之没有任何破译技艺方面的严肃作品，在很大程度上导致了我们对密码系统价值的错误认知。[[10](#ref-10)]


他直接指出当时大多数密码系统的缺陷：无法提供不可破译性的严格保证。[[10](#ref-10)]因此，当其他密码学家还在讨论各种密码系统的时候，柯克霍夫直奔时代主题：

> “因此我想到，向那些对军事密码学发展感兴趣……的人提供拟用于战争的各种密码编制和评估的指导原则，使他们从中受益。”[[1](#ref-1)]


他在《军事密码学》中第一次提出通用系统和具体密钥的区别（二者已成为现代密码学的基本概念）：一直以来，“秘密”（secret）是指“构成系统的物质部分：密码表（tableaux）、代码书（codebooks）或各种必要的机械设备”，而非“密钥本身”[[10](#ref-10)]。
与这种保密系统的隐蔽式安全截然相反，柯克霍夫提出的通用系统被认为是一个开放式的共享系统，人们无需担心在信息传送过程中秘密泄露的问题：

> “不需要凭空想象和怀疑雇员或下属的清白，就可以理解，如果一个要求保密的系统经太多人之手，凡是参与过的人都可能会泄露系统。”
……

> “行政部门[…]必须绝对放弃秘密方法，并将其作为一项原则，即只接受可以在我们的学校中公开教授的程序……如果合适的话，我们的邻国甚至可以复制和采用这种方式。”[[10](#ref-10)]


这就是著名的柯克霍夫原则——“既然密码系统的任何细节已为人悉知，只要密钥未泄露，它也应是安全的。”
柯克霍夫认为，在一个密码系统中，密钥才是成本最低的保密元素，即使泄露，系统的恢复难度也很小。因为，他将电报与战地密码看成必然，认为任何切实可行的密码都必须能够承受大量报务压力，且“任何用于军事目的的密码学方法都必须适用于电报”[[10](#ref-10)]。

他对两种系统进行区分，“一种用于少数人的临时通信，一种用于不同军队长官的长期通信”[[10](#ref-10)]。密码学为适应这种迅捷快速的通信需求必须要将密码系统在泄露时的恢复成本降至最低，否则人类无法普遍地享有一套安全而持久的密码安全系统。

很显然，柯克霍夫提出的密码学基本假设是基于对未来长期的、远程的、简单的、可靠的即时通信趋势的预判，尽管他并未意识到这正是 20 世纪以来计算机、互联网、万维网时代的基本要求。

柯克霍夫提出的密码学原则实际上是发动了一场持续近一个世纪的运动。现代密码学之一的对称密钥加密就实现了系统公开与通信双方使用共同的密钥进行沟通，而 1976 年公钥密码学的诞生则将这场世纪运动发展至顶峰，即密码系统的秘密部分减少至最小，公钥仍然可以公开，只有私钥才是保密的。[[8](#ref-8)]

当然，从柯克霍夫所提的第三条原则“双方可以容易地改变密钥”中可以看出，他的基本假设是单钥加密，并未意识到可以实现公钥加密。但是，他所指出的“密钥必须易于沟通和记忆，而不须写下”，依然对加密行业有借鉴与指导意义。虽然私钥已经用人类可读的助记词来表示，但仍然不易于记忆且必须写下，如果能在这个问题上有所突破，那私钥与链上资产的安全性将得到更好的保障。

作为一个实用主义者，柯克霍夫将密文的保密性完全建立在一个容易记忆和修改的密钥的保密性上，但他意识到，要在当时的条件下设想一个在数学上不被破解的系统是不可能的，故而追求的是在实践中无法被破解的系统。与数学相比，他更注重的是这种实际安全。[[10](#ref-10)]

柯克霍夫在这一点上的洞见仍然为现代密码学家沿用。譬如，比特币先后使用的 ECDSA 与 Schnorr 数字签名算法均基于“离散对数”假设。这个困难假设假定在特定群中，不存在求解出离散对数的多项式时间算法。因此，该密码方案的安全性建立在“多项式时间”算法不可解而非“任意”算法之上，这正是柯克霍夫追求的“实际安全”原则的一次具体体现。

除了提出关于加密的基本条件外，《军事密码学》在本质上是一部密码分析手册，该书全文都在为密码分析正名。[[1](#ref-1)]在具体的密码分析方式上，柯克霍夫发现同时代密码学家通过数学证明来论证密码系统合理性上的尝试屡遭失败，因此另谋他法，提出一种通过密码分析攻击来检验密码系统安全的范式。[[14](#ref-14)]

柯克霍夫相信，只有密码分析员才知道密码系统的安全性，只有破译才能有效地测试一种密码的保密性能。在他看来，密码分析是通向密码学光明大道的唯一途径，只有通过艰难险峻的密码分析之路，才能抵达密码系统的真理之颠。[[1](#ref-1)]

他将密码分析确立为军事密码唯一可靠的检验方法，而这个检验方法持续至今。最著名的实践案例要属 20 世纪末的开放源代码运动，作为主要领导人之一的埃里克·雷蒙（《大教堂与集市》的作者）重新表述了柯克霍夫原则：“任何不假定敌人拥有源代码的安全软件设计都是不可信的；因此，永远不要相信闭源代码”[[13](#ref-13)]。此后，在开源运动影响下的所有民用密码学算法都遵循柯克霍夫的系统公开原则，因为只有经受了来自一个公开的、活跃的铁杆密码学家社区的无数次攻击后，这个密码学算法才会被认为是安全的。[[8](#ref-8)]

与此同时，当系统出现安全问题时，柯克霍夫原则成为一种普遍的衡量标准。譬如，2004 年 5 月 15 日，一名黑客闯入思科内部网络，窃取 IOS 路由器固件的源代码并将其散布在网上。雷蒙在一封邮件中写道，这些代码泄露事件可能意味着“一波针对互联网关键路由器基础设施的漏洞正在到来”。因此，无论是网络安全专家还是普通用户，大家最关心的是 IOS 是否遵循了柯克霍夫原则。在雷蒙看来，“如果思科忽视柯克霍夫原则，用户将会付出代价”，但如果“IOS 一开始就是开源的，我们就有坚实的基础相信它通过了柯克霍夫测试——开源使你诚实”。[[13](#ref-13)]类似的事件不断推动用户对产品代码的检查，这就是柯克霍夫为现代社会留下的宝贵遗产。

当然，柯克霍夫并未停止脚步，他还为后世密码分析学贡献了重叠法和位对称法两种密码分析法，尽管不及“卡西斯基分析”为这门学科带来的变革的颠覆性，但它们仍然在大部分现代破译中扮演着举足轻重的角色。[[1](#ref-1)]

![军事密码学](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.9%20%E3%80%8A%E5%86%9B%E4%BA%8B%E5%AF%86%E7%A0%81%E5%AD%A6%E3%80%8B.png?raw=true)

Fig. 9：1883年，柯克霍夫发表的《军事密码学》

图片来源：https://archive.org/details/lacryptographie00kercgoog/page/n4/mode/2up

《军事密码学》被称为有史以来最简洁的密码学著作，柯克霍夫凭一己之力将当时全部已知的密码学领域知识浓缩在这本只有64页的小书中。
该书出版后迅速成为参考文献，抱着复仇心态的法国陆军部购买 300 本作为必读书目，并在柯克霍夫原则的指导下不断开发新的密码，旨在即使对手知道编码和解码算法也能抵御，但简单到可以向军事人员解释和教授。[[1](#ref-1)]

从 1883 年到 1914 年，法国出版 24 部关于密码学的作品和小册。这些法国密码学作品对柯克霍夫的《军事密码学》极力吹捧，作为柯克霍夫忠实粉丝的炮兵少校约瑟将柯克霍夫所提的六项原则浓缩成一条准则：“准确地说，军事密码须采用一种只需纸和笔的系统”，这似乎决定了一战前法国战地密码的选择。有趣的是，由于经常引用柯克霍夫的话，约瑟感觉有必要在一大段引文之后插入一句“柯克霍夫先生，他的名字经常在密码学中经常出现”以示歉意。[[1](#ref-1)]

可以说，在柯克霍夫的直接影响下，法国密码学在一战前进入全面复兴的黄金时期。
## 四、柯克霍夫与沃拉普克：世界主义者的狂欢与悲歌
在柯克霍夫留下的遗产中，沃拉普克语（Volapük）是常为人所忽视的，但是柯克霍夫却深刻地参与了这场世界语运动，并先后经历了属于世界主义者的狂欢与悲歌。
### （一）共谋：世界主义者的不约而同
沃拉普克语起初是由一位名叫约翰·马丁·施莱尔的天主教神父于 1879 年 5 月发明的。据说某一天，施莱尔从邻居处听说自己寄给远在美国的儿子的所有信件都没有送达，追究后得知，邮局拒绝了所有的信件，因为施莱尔不会用英文写作，收件人地址均出现拼写错误。这件事激发了他创造一种新的语言，它具有更简单的拼写规则，可以在世界各地使用。[[7](#ref-7)]

根据施莱尔的笔记，他学习了 80 多种语言，能说近 50 种语言，不仅懂欧洲语言，还懂亚洲语言，比如日语和梵语。据此，施莱尔决定将新的世界语言建立在他认为是世界六大主要“文化语言”的基础上，包括英语、德语、法语、西班牙语、意大利语和俄语。[[7](#ref-7)]

1880 年，第一部沃拉普克语教科书出版，这门新的语言被称作“世界语言”（the world language）：“vol”代表“世界”（world）、 “pük”代表“语言”（language），这是人类第一次以人造语言统一世界的伟大尝试。[[7](#ref-7)]

柯克霍夫本质上也是一个世界主义者。尽管《军事密码学》在某种程度上是民族主义的产物，并且结出了民族主义的果实，但从密码学本身来看，柯克霍夫所提出的通用系统则更具有开放性与国际性，这也是 20 世纪下半叶密码朋克（cypherpunk）与柯克霍夫原则跨世纪联合的渊源所在。

柯克霍夫诞生于荷兰，游学于欧洲，定居于法国，掌握英语、现代与古代德语、荷兰语、法语等多种欧洲语言，他的生命之旅及其对知识与真理的追求是跨国界的。沃拉普克语的出现戳中了柯克霍夫的世界主义与国际主义理想的情怀，1884 年，49 岁的柯克霍夫在《军事密码学》出版后加入沃拉普克语运动，成为一名沃拉普克主义者。
### （二）狂欢：从欧陆到世界
在柯克霍夫加入沃拉普克的这一年，正值第一届沃拉普克语大会的召开，当时只有 150 名沃拉普克主义者聚集在德国弗里德里希港市。1885 年，柯克霍夫成立法国沃拉普克语传播协会，该协会聚集了包括科学界、政府官员、艺术家、记者和工业家在内的 50 多位非常有名的社会人士，拉开了这场世界语狂欢的序幕。在《时报》、《小日报》和《自由报》等著名报纸的宣传下，沃拉普克语风靡法国，不仅在知识分子中，而且在社会各阶层流行，甚至大街上也能听到有人说沃拉普克语。从法国开始，沃拉普克语相继传入西班牙、葡萄牙和比利时。[[5](#ref-5)]

或许是巴黎高等商学院的商业导向，又或许是延续着密码学研究中的务实精神，柯克霍夫在沃拉普克语运动中从一开始就展现了实用主义倾向的工具理性。1885 年 7 月，柯克霍夫发表《通用贸易语言沃拉普克语》。同年，他在巴黎高等商学院的沃拉普克语课程开幕式演讲中强调了殖民主义时代通用语言之于现代商业的意义：

> 正如外交官在国际交往中拥有一种通用或共同的语言一样，学者、旅行者和商人也会发现在与欧洲的不同民族乃至世界上所有的文明国家交往中使用一种简单而实用的交流方式大有裨益。

> 每个人都知道，与外国人进行商业往来是非常容易和安全的，因为通过缔约双方都知道的语言，可以更清楚、更准确地订立协议。然而，人们很容易忽视这样一个事实，即在目前使用的八百多种语言中，至少需要懂得四五十种语言，才能与主要的文明国家保持沟通，在过去的半个世纪里，铁路和汽船使我们与这些国家保持了持续的沟通。

> 现在，如果在几年内学会三、四种罗马语或日耳曼语并不困难，那么要掌握一种印度语或闪族方言则需要更长的时间。如果考虑到土耳其语或日语这样的黏着语，或者像汉语或安南语这样的单音节语，那么这些困难对许多人来说甚至是无法克服的；而且，讲汉语方言或采用汉语书写的人，仍然占世界总人口的三分之一。
当东方国家希望与欧洲进行商业往来时，他们的处境就更加尴尬了。由于缺乏地理知识以及政治领袖不完全了解情况，他们通常不得不求助于殖民者或定居的外国人的调解，从而成为政治和宗教仇恨引起的阴谋的受害者。

> 如果采用一种通用语言，情况就会完全改变；同一个旅行者可以在极其不同的国家访问，在所有生产和消费中心可以阅读和理解同一份商业杂志，伦敦或巴黎房价会被北京、江户、马德拉斯、亚历山大、君士坦丁堡和莫斯科的商人所评论! [[5](#ref-5)]

作为一个极具时代精神（Zeitgeist）的人，柯克霍夫将沃拉普克语作为一种简单实用的商业导向的语言，而非施莱尔等学者所主张的一种美学的、知识性的构建。

换言之，大航海时代以来，人类在 19 世纪殖民主义全球扩张下前所未有地连成了一个整体，而柯克霍夫希望通过沃拉普克语这样的世界语打破巴别塔的语言鸿沟，在一个资本主义横行的时代里实现一个更加广泛而统一的世界。为此，柯克霍夫不遗余力地推广沃拉普克语。同时，他接连出版《沃拉普克语完整教程》、《沃拉普克语的第一要素》、《沃拉普克语的简明语法》、《法语-沃拉普克语双语字典》与《对沃拉普克语应引入的一些简化措施的严格审查》等著作，降低沃拉普克语的学习门槛。

至 1887 年 7 月，第二届沃拉普克语大会在慕尼黑举办，本次大会与会人数众多，并且首次迎来了真正的国际访客。为了继续发展沃拉普克语运动，大会成立了国际沃拉普克语学院，该学院由来自 15 个不同国家的 29 名成员组成，柯克霍夫担任学院院长。在此影响下，沃拉普克语运动于 1888 年发展至全盛，这一年有 182 种沃拉普克语教材问世，出版速度达到每两天一本。到 1889 年，世界各地有 25 种沃拉普克语或与之相关的期刊发行，283 个沃拉普克语俱乐部组织聚会。[[1](#ref-1)]

1889 年 8 月，柯克霍夫在巴黎主持召开了第三届沃拉普克语大会，沃拉普克语仍然是大会的交流语言，而服务生和门童也在用沃拉普克语交流。同一时期举办的巴黎世界博览会更是见证了沃拉普克语运动的巅峰，柯克霍夫还代表巴黎人类学会为博览会免费举办关于沃拉普克语的讲座，即“12 种语言的沃拉普克语法”（Volapük grammar in 12 languages）。

有趣的是，时任美国总统格罗弗·克利夫兰的妻子将她的狗取名为“Volapük”。沃拉普克语对青年学生的影响同样深刻，据柯克霍夫的信函介绍，他曾在巴黎高等商学院举办过 5 次沃拉普克语讲座，通过考试就可以获得证书，大多数学生都表示“希望向他们的家人展示他们的证书”，因为“拥有沃拉普克语的文凭证明是最有意义的”[[5](#ref-5)]。

短短数年，在柯克霍夫等人的领导下，沃拉普克语运动从德法蔓延到欧陆其他国家又渐次在全球遍地开花，从最初只有 150 名成员的社区发展成巅峰时期拥有 21 万爱好者的庞大组织。对柯克霍夫而言，真正的狂欢正是这种世界范围内对沃拉普克语的普遍认同。

![1887年国际沃拉普克语学院](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.10%201887%E5%B9%B4%E5%9B%BD%E9%99%85%E6%B2%83%E6%8B%89%E6%99%AE%E5%85%8B%E8%AF%AD%E5%AD%A6%E9%99%A2.jpg?raw=true)

Fig. 10：1887 年国际沃拉普克语学院（The International Volapük Academy），施莱尔在图片中间，柯克霍夫的照片在施莱尔右边。

图片来源：“Kerkchoffs‘ Legacy”.

### （三）悲歌：来自内部的撕裂
然而，全盛也意味着衰落的开始，狂欢终有落幕，丧钟奏响悲歌。

首先，作为一个世界主义者与一个沃拉普克语运动的主要领导者，柯克霍夫却始终被民族国家围困，他试图构建的作为通用语言的沃拉普克语与 19 世纪下半叶法国现代国家建设以及国家的社会组织模式之间存在紧张关系。

1879 年至 1899 年间，法兰西第三共和国长期由温和共和派（又称机会主义共和派，Républicains opportunistes）执政，历届政府都在培养“共和国爱国者”。普法战争结束后，民族国家之间竞争激烈，民族主义与爱国主义是欧洲的主流思潮。因此，法国政府与巴黎高等商学院对超越民族国家边界的世界主义运动尤为敏感。1889 年，柯克霍夫写给商学院的信函中表示，自己“从未鼓励任何学生参加任何形式的沃拉普克语讲座”，并且进一步声明“谨慎地避免了任何可能违背你或总统意愿的行动”。他“决心避免与政府发生任何争端”，甚至承诺“如果政府同意，我将完全取消对沃拉普克主义者的支持”[[5](#ref-5)]。

其次，它源自施莱尔与柯克霍夫之间的冲突，前者要创造一个最丰富、最完美的文学语言，后者则希望将其塑造为一个简单而实用的商业和科学语言。

事实上，柯克霍夫的语法书从一开始就删去施莱尔母语德语在沃拉普克语中的痕迹，但施莱尔认为自己才是沃拉普克语之父，自己更应该对任何变动拥有决定权。

二者冲突愈演愈烈，直至 1889 年矛盾公开化，沃拉普克语运动随之分为两个对立的团体：以施莱尔为主的保守派和以柯克霍夫为主的改革派。此后，两派各自选出沃拉普克语学院的成员。当柯克霍夫决定在巴黎召开第三届沃拉普克语大会以使学术界能够自由决定所需的改革时，施莱尔立即宣布这次大会及其未来决定的无效。施莱尔还邀请自己派别的学者参加 5 月 12 日在阿尔门丁根举办的会议，这次会议只批准改革派所要求的一小部分修改。

不过，由于美国沃拉普克主义者和外交官查尔斯·斯普拉格的调和，柯克霍夫主持的第三届沃拉普克语大会并没有实现沃拉普克语的基本改革。但内部改革的呼声却日益水涨船高。1890 年，柯克霍夫出版了一部完整的“常规语法”引起保守派的强烈抗议。作为回应，施莱尔成立一个全新的沃拉普克语学院，后又将柯克霍夫从沃拉普克主义者的名单中除名。[[5](#ref-5)]

这一激进行为对沃拉普克语在欧洲国家的声誉造成巨大损害，尽管其在美国和其他非欧洲国家蓬勃发展，但到1891年底，沃拉普克语运动已经失去四分之三的成员。内部的分崩离析、共识的四分五裂以及国家的压力终于让57岁的柯克霍夫感到绝望。

1892 年，柯克霍夫离开沃拉普克语学院，也告别了沃拉普克语。令人唏嘘的是，这个曾经拥有 21 万人的沃拉普克语通讯名录，在 1902 年只剩下 159 人。[[5](#ref-5)]

噫吁嚱！共识之难，难于上青天！

## 五、余声：柯克霍夫的最后十年
或许是沃拉普克语世界主义理想的幻灭，柯克霍夫内心充满苦闷。当商务部长委托他在巴黎高等商学院的期末考试上进行德语问卷调查时，柯克霍夫公开批评了商务部考官执行任务的方式，此举导致他在 1891 年与巴黎高等商学院的合同到期时未能续签。

随后，柯克霍夫在法国阿基坦省蒙特-德-马尔桑中学谋得德语教席。这所中学的上级领导评价他：“知识极为广泛，教授方法灵活、严密、准确，这在一个兴趣如此广泛的人身上难得一见。”[[1](#ref-1)]为了离巴黎更近，柯克霍夫又于次年 9 月 16 日搬到布列塔尼海港洛里昂的一所高中教授德语。

不过，柯克霍夫似乎并没有彻底与沃拉普克语断绝关系，它与发生在 19 世纪末法兰西第三共和国的重大政治与司法丑闻德雷福斯事件（Affaire Dreyfus）② 相关。在这场事件中，由于军方与法院沆瀣一气，引起公众强烈不满。该事件中所反映出来的反犹主义问题将整个法国社会撕裂成两大极端阵营。

在朴素的正义观驱动下，柯克霍夫也签署了一份请愿书：

> 以下签名者以被遗忘的法律的名义抗议，反对针对皮卡尔上校的追捕和迫害，他是主张进行重审的英雄将士。[[5](#ref-5)]

同时，长期接受共和派领导的“共和国爱国者”柯克霍夫也强烈反对反犹主义，他将反犹主义与施莱尔创造的沃拉普克语相联系，表达自己的立场：

> 在我们看来，像是犹太人[德国的贬义Judeln]意思的 yudanæn 这样的词甚至应该从沃拉普克语中被禁止；我们不想与反犹主义有任何关系！[[5](#ref-5)]

由于他在德雷福斯事件中的公开行动，柯克霍夫被校长评价为“非常杰出”和“有良知”的人。

到了 1899 年，柯克霍夫为法国密码学贡献了最后一份薄力，他在国立文献典章学院举办了为期两年的密码学公开讲座。1900 年，柯克霍夫回到了巴黎，仍然担任德语教师。

1903 年 8 月 9 日，当 68 岁的柯克霍夫在瑞士的小镇德利根度假时，他因想从车站向即将到来的火车上的熟人问好，却出乎意料地被火车夺走了生命。

柯克霍夫被埋葬在巴黎南部具有永久特许权的蒙帕纳斯公墓（Cimetière du Montparnasse）中。2020 年 5 月 12 日，当雷米·格罗-斯图尔特与大卫·纳卡奇两人前去墓地回访时，发现这座古老的坟墓极为简陋，无人打理、无人献花，因此代表国际密码学界重新兴建了柯克霍夫墓。他们还正式提请法国当局注意柯克霍夫墓的历史意义与重要性，以避免其在未来被回收。[[5](#ref-5)]

![image alt](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.11%20%E5%9F%8B%E8%91%AC%E8%AF%81%E6%98%8E.jpg?raw=true)

Fig. 11：柯克霍夫的埋葬证明（编号 646）

图片来源：“Kerkchoffs‘ Legacy”.

![柯克霍夫墓1](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.12%20%E6%9F%AF%E5%85%8B%E9%9C%8D%E5%A4%AB%E5%A2%931.jpg?raw=true)


![柯克霍夫墓2](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.13%20%E6%9F%AF%E5%85%8B%E9%9C%8D%E5%A4%AB%E5%A2%932.jpg?raw=true)

Fig. 12&13：2020 年 5 月 12 日，雷米·格罗-斯图尔特与大卫·纳卡奇等代表国际密码学界对柯克霍夫墓进行重建

图片来源：“Kerkchoffs‘ Legacy”.

柯克霍夫是属于通才的一代。作为一个智识的追求者，在学科专业化刚形成的 19 世纪，他的求知欲促使其横跨科学与人文“两种文化”，其对知识与真理的向往是超越性的。同时，他对事物的洞悉一样具有超越时代的本能，他的人生一边在回应着时代的困境与需求，一边将自己的超越性理想寄托其中。

当然，可能会有人感到遗憾，一个具有世界主义理想的人仍然困于近代欧洲民族主义与民族国家建设的枷锁，但我们仍应对历史抱以“理解之同情”——民族主义与世界主义都是19世纪时代精神的体现。柯克霍夫是一个充满张力的人，正因为民族国家这个强大的统治机器的衬托，才更能彰显出他超越狭隘民族主义的思想的可贵。

一个多世纪前的世界语运动早已无人问津，但仍然蕴藏着柯克霍夫的世界主义理想的密码学思想却闪耀于后世。从《通信的数学理论》到《密码学的新方向》，从布鲁斯·施奈尔到埃里克·雷蒙，柯克霍夫原则不仅指引着现代密码学的发展，还为现代密码系统的安全保驾护航。

回到文章开头，如果时光可以倒流，你愿意学习一种符合柯克霍夫原则的密码学方法与通信手段和自己喜欢的人进行交流吗？这何尝不是柯克霍夫的美好憧憬？他在《军事密码学》中表示，如果采用系统公开的密码学原则，“我们的学生将自由地与他们喜欢的人交流”[[10](#ref-10)]。



---

### 致谢
本文系原语里弄（Primitives Lane）资助课题「寻找密码朋克」专题研究成果之一，在此特别感谢原语里弄发起人姚翔老师、BODL Ventures 合伙人刘锋老师、安比实验室创始人郭宇老师与复旦大学密码学博士 Kurt Pan 的悉心评阅与宝贵建议，感谢原语里弄的 Raphina 在本文写作过程中提供的大量帮助！没有你们，本文的写作是难以想象的。同时，巴黎高等师范学院的雷米·格罗-斯图尔特（Rémi Géraud-Stewart）博士与大卫·纳卡奇（David Naccache）教授在资料方面为本文提供了坚实的保障，一并表示感谢！

### 申明
本研究报告获得原语里弄资助，为研究员独立研究成果，不构成任何投资建议。本报告遵循 CC 4.0 BY-NC-ND 版权协议，对其的任何引用、参考或转载，均须附上原文出处、链接和本声明。了解更多信息，请访问原语里弄网站 https://www.primitiveslane.org/ 。


---


### 注释
① 1870 年 1 法郎≈0.29 克黄金，换算成 2022 年人民币，其年薪约为 28 万有余。

② 德雷福斯事件起源于 1894 年 9 月法国情报机构发现法国炮兵试图向德国提供法国军事情报，最后调查人员将目标锁定至法国陆军炮兵上尉军官阿尔弗雷德·德雷福斯。德雷福斯是犹太裔，普法战争后举家从阿尔萨斯迁居巴黎，但仍有部分兄弟保留德国国籍，以经营在德之工厂。入伍后，德雷福斯在 1893 年 1 月 1 日进入陆军总参谋部工作。由于 1871 年第三共和国建立以来政府高层贪污受贿、腐败事件频传，其中在法国金融界占有很大势力的犹太银行家经常卷入与政客勾结的丑闻中，故而反共和派抨击犹太人在政府的贪污腐败问题上难辞其咎，由此加重了军界与社会上的反犹主义氛围。在德雷福斯事件爆发前两年，巴拿马运河丑闻也进一步促进了反犹主义的上升。因此，作为总参谋部唯一的犹太人，在当时反犹氛围极其浓烈的军界，德雷福斯被指控触犯叛国罪。两年后，新任情报机构领导人乔治·皮卡尔搜集到证据表明一名名叫费迪南德·沃尔辛·埃斯特哈齐的法国陆军少校才是真正的间谍。然而，法国总参谋部却因担心承认错误会使军方的“荣誉”扫地而压制了新证据，军事法庭也一致宣判埃斯特哈齐无罪。作为回应，军方还伪造证据污蔑德雷福斯，并且捏造假证据打击皮卡尔，连带使皮卡尔撤职被捕。此事引起公众的愤怒，知名作家埃米尔·左拉（Emile Zola）在 1898 年 1 月 13 日发表《我控诉…！》（J’accuse…！），揭示掩盖真相的行为，以及首先发现证据的皮卡尔上校所经历的羞辱。最终，左拉也因此被法院判处毁谤罪，并被处以一年徒刑而流亡英国以躲避政府的抓捕和狂热派的刺杀。不过，左拉的行动开启了为期十多年、天翻地覆的法国社会大改造运动（1898-1914），此后经过多次重申以及政治环境的变化，德雷福斯于 1906 年 7 月 12 日获得平反。在此前后，法国社会改造运动也以 1905 年法国政教分离法的通过而达到高峰。

### 参考文献


<div id = "ref-1" ></div>
[1] （美）戴维·卡恩著：《破译者：人类密码史》（上下册），朱鸿飞，张其宏译，北京：金城出版社有限公司，2021 年 6 月。

<div id = "ref-2" ></div>
[2]（英）西蒙·辛格著：《码书：编码与解码的战争》，刘燕芬译，南昌：江西人民出版社，2018 年 3 月。

<div id = "ref-3" ></div>
[3] Marvin the Robot：《互联网的鼻祖-电报：信息时代的开始》，Kaspersky daily，2015 年 6 月 15 日，https://www.kaspersky.com.cn/blog/互联网的鼻祖-电报：信息时代的开始/3153/ (accessed on October 22, 2022)

<div id = "ref-4" ></div>
[4] Boukhonine, Sergai, Cryptography: A Security Tool of the Information, http://www.bauer.uh.edu/uhisrc/FTB/Cryptography/FTBCryptography.pdf (accessed on November 4, 2022)

<div id = "ref-5" ></div>
[5] Caraco, Jean-Claude, Géraud-Stewart, Rémi, Naccache, David, Kerckhoffs’ Legacy, May 19, 2020, https://eprint.iacr.org/2020/556.pdf (accessed on October 22, 2022)

<div id = "ref-6" ></div>
[6] Géraud-Stewart, Rémi, Naccache, David, “A French cipher from the late 19th century,” Cryptologia 4, vol. 45, July 4, 2021: 342-370, https://eprint.iacr.org/2020/390.pdf (accessed on November 4, 2022)

<div id = "ref-7" ></div>
[7] Gryazin, Ivan, Volapük: The Would-be Language of the World, The Glossika Blog, June 2, 2022, https://ai.glossika.com/blog/volapuk-the-would-be-language-of-the-world (accessed on November 4, 2022)

<div id = "ref-8" ></div>
[8] Guillot, Philippe, “Auguste Kerckhoffs et la cryptographie militaire,” Bibnum  [En ligne], Calcul et informatique, May 1, 2013, http://journals.openedition.org/bibnum/555 (accessed on November 4, 2022)

<div id = "ref-9" ></div>
[9] Kahn, David, The Rise of Intellegence, Foreign Affairs, vol. 85, No.5, Sep. - Oct., 2006: 125-134, https://www.jstor.org/stable/20032075 (accessed on November 4, 2022)

<div id = "ref-10" ></div>
[10] Kerckhoffs, Auguste, “La cryptographie militaire,” Journal des sciences militaires, vol. IX, January 1883: 5-38, February 1883: 161-191, https://www.petitcolas.net/kerckhoffs/la_cryptographie_militaire_i.htm (accessed on December 8, 2022)

<div id = "ref-11" ></div>
[11] Korrespondenz Auguste Kerckhoffs – Hugo Schuchardt, April 25, 1888, from HUGO SCHUCHARDT ARCHIV, https://gams.uni-graz.at/context:hsa.letters.1898?locale=de (accessed on November 4, 2022)

<div id = "ref-12" ></div>
[12] Nehra, William, Dutch Folklore: The Bokkenrijders, June 4, 2020, https://www.iamexpat.nl/lifestyle/lifestyle-news/dutch-folklore-bokkenrijders (accessed on October 16, 2022)

<div id = "ref-13" ></div>
[13] Eric S. Raymond’s Letter, https://lwn.net/Articles/85958/ (accessed on December 8, 2022)

<div id = "ref-14" ></div>
[14] Diffie, Whitfield, Hellman, Martin E., New Directions in Cryptography, IEEE Transactions on Information Theory, vol. 22, no. 6, November 1976: 644-654, https://evervault.com/papers/diffie-hellman.pdf (accessed on December 9, 2022)


### 附录：Kerckhoff 家族的血脉
柯克霍夫家族是林堡省最古老、最体面的家族之一。在可考的历史中，柯克霍夫家族成员的职业多是医生、市政议员或村长，始终保持着优越的社会地位。譬如，柯克霍夫的曾曾祖父弗朗西斯·克恩拉杜斯·柯克霍夫是外科医生，曾祖父乔纳斯·弗朗西斯·卡罗勒斯·柯克霍夫是努斯市政议员、村长、外科医生。他的祖父约翰尼斯·弗朗西斯·柯克霍夫曾被授权为黑措根拉特的地方行政长官举办会议。他的叔祖父约瑟夫·罗曼·路易斯·柯克霍夫是医学博士，先后担任拿破仑军队的医生与荷兰军事医院的首席医生，并被比利时第一任国王利奥波德一世封为爵士。[[5](#ref-5)]

柯克霍夫家族谱系之所以如此清晰，得益于柯克霍夫的叔祖父约瑟夫对家族背景的强化。因为约瑟夫的祖父弗朗西斯（也就是柯克霍夫的曾曾祖父）的两个侄子约瑟夫·柯克霍夫与巴尔塔萨·柯克霍夫曾在 1771 年前后被判定为荷兰民间传说“山羊骑士”（Bokkenrijders）犯罪团伙领袖，约瑟夫认为这是新兴柯克霍夫家族的耻辱。据传说，山羊骑士是骑着有翅膀的山羊在天空中飞翔的恶魔，他们与撒旦建立契约，恐吓荷兰和比利时的林堡省。到了 18 世纪，一些小偷和犯罪团伙会打着“山羊骑士”的旗号在林堡杀人放火。或许因为“山羊骑士”的残酷罪行，政府对“山羊骑士”的审判也是无情的。他们被视作不敬上帝的“异端”，需要接受残忍的酷刑。为了抓捕“山羊骑士”，大量无辜的人被指控，他们往往只是因为可怕的酷刑而招供。[12]柯克霍夫家族的两名成员均在此例，其中身为外科医生、奥地利军医的约瑟夫·柯克霍夫宁死不屈，而巴尔塔萨则被迫招供。

从其族谱来看，Kerckhoff 家族成员确实享有一定的社会地位，而约瑟夫在 1830 年代对族谱的强化同样提升了家族的社会地位。

![族谱](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.14%20%E6%97%8F%E8%B0%B1.jpg?raw=true)
Fig. 14：柯克霍夫家族族谱


![贵族纹章](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.15%20%E8%B4%B5%E6%97%8F%E7%BA%B9%E7%AB%A0.jpg?raw=true)
Fig. 15：1830 年柯克霍夫家族贵族纹章
图片来源：“Kerkchoffs‘ Legacy”.

![家族文件](https://github.com/PrimitivesLane/Research/blob/main/Cryptographers/pics/fig.16%20%E6%9C%80%E6%97%A9%E7%9A%84%E5%AE%B6%E6%97%8F%E6%96%87%E4%BB%B6.jpg?raw=true)
Fig. 16：1679 年，与柯克霍夫直系血统相关的最早的家族文件
图片来源：“Kerkchoffs‘ Legacy”.

